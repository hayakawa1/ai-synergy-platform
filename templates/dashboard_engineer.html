{% extends "base.html" %}

{% block authenticated_content %}
<div class="space-y-6">
    <!-- 応募済み案件 -->
    <div class="bg-white shadow sm:rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <h2 class="text-lg font-medium text-gray-900">応募済みの案件</h2>
            <div class="mt-6 space-y-4">
                {% for proposal in current_user.proposals %}
                <div class="border rounded-lg p-6 hover:border-primary-500 transition-colors duration-150">
                    <div class="sm:flex sm:items-center sm:justify-between">
                        <h3 class="text-lg font-medium text-gray-900">
                            <a href="{{ url_for('project_detail', project_id=proposal.project.id) }}" class="hover:text-primary-600">
                                {{ proposal.project.title }}
                            </a>
                        </h3>
                        <div class="mt-2 sm:mt-0 text-sm text-gray-500">
                            応募日: {{ proposal.created_at.strftime('%Y年%m月%d日') }}
                        </div>
                    </div>
                    <p class="mt-2 text-gray-600">{{ proposal.content[:200] }}{% if proposal.content|length > 200 %}...{% endif %}</p>
                    
                    <div class="mt-4 flex flex-wrap gap-4 text-sm text-gray-500">
                        {% if proposal.project.budget_min or proposal.project.budget_max %}
                        <span class="inline-flex items-center">
                            <svg class="mr-1.5 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            {% if proposal.project.budget_min %}¥{{ "{:,}".format(proposal.project.budget_min) }}{% endif %}
                            {% if proposal.project.budget_min and proposal.project.budget_max %} 〜 {% endif %}
                            {% if proposal.project.budget_max %}¥{{ "{:,}".format(proposal.project.budget_max) }}{% endif %}
                        </span>
                        {% endif %}
                        
                        <span class="inline-flex items-center">
                            <svg class="mr-1.5 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
                            </svg>
                            納期: {% if proposal.project.deadline %}{{ proposal.project.deadline.strftime('%Y年%m月%d日') }}{% else %}未設定{% endif %}
                        </span>

                        {% if proposal.url %}
                        <a href="{{ proposal.url }}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-primary-600 hover:text-primary-500">
                            <svg class="mr-1.5 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
                            </svg>
                            ポートフォリオ
                        </a>
                        {% endif %}
                    </div>
                </div>
                {% else %}
                <div class="text-center py-12">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                        <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
                    </svg>
                    <h3 class="mt-2 text-sm font-medium text-gray-900">応募した案件はありません</h3>
                    <p class="mt-1 text-sm text-gray-500">案件一覧から興味のある案件に応募してみましょう。</p>
                    <div class="mt-6">
                        <a href="{{ url_for('project_list') }}" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700">
                            <svg class="mr-2 -ml-1 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                            案件を探す
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- 案件を探すボタン -->
    <div class="flex justify-end">
        <a href="{{ url_for('project_list') }}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700">
            <svg class="mr-2 -ml-1 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            案件を探す
        </a>
    </div>
</div>
{% endblock %}
